# Контейнер Docker c Сервером 1С

## Сборка ораза Docker:

### Подготовка дистрибутивов

#### Cервер 1С:Предприятие

Скачать с ресурса https://relises.1c.ru дистрибутив сервера 1С:Предприятие 8.3 для rpm-based 64-битной Linux, распаковать.

Поместить установочные файлы в каталог _dist/1c_:
 - 1C_Enterprise83-common-{версия}.x86_64.rpm
 - 1C_Enterprise83-common-nls-{версия}.x86_64.rpm
 - 1C_Enterprise83-server-{версия}.x86_64.rpm
 - 1C_Enterprise83-server-{версия}-1063.x86_64.rpm
 - 1C_Enterprise83-ws-{версия}.x86_64.rpm
 - 1C_Enterprise83-ws-nls-{версия}.x86_64.rpm

#### Драйвер HASP защиты

Скачть с ресурса http://ftp.etersoft.ru/pub/Etersoft/HASP/last/x86_64/CentOS/7 дистрибутивы:
 - haspd-7.90-eter2centos.x86_64.rpm
 - haspd-modules-7.90-eter2centos.x86_64.rpm
 
Поместить установочные файлы в каталог _dist/hasp_.

### Шрифты Microsoft Core Fonts

Поместить файлы шрифтов (.TTF) в каталог _fonts_

### Версия сервера 1С

Установить версию сервера 1С в файде _Dockerfile_ в переменной окружения _VER_1C_ 

Установить версию сервера 1С в файле _/scripts/version.cmd_ в переменной окружения _ver_

## Формирование образа Docker

Сборка образа выполняется скриптом _scripts/build.cmd_

Сборка образа без использования кэша (иногда требуется при ошибках) выполняется скриптом _scripts/build_no-cache.cmd_

Публикация образа на Docker Hub выполняется скриптом _scripts/push.cmd_

Комбинированная операция "сборка + публикация" выполняется скриптом _scripts/publish.cmd_ 

## Тестовый запуск контейнера

Создание и запуск контейнера выполняется скриптом _scripts/run.cmd_

Для подключения к серверу, необходимо выполнить следующие действия:

- Прописать в локальный файл "hosts" имя "1c-server" на адрес "127.0.0.1"

- Подключиться к кластеру серверов 1С-Предприятие через консоль администрирования по имени "1c-server"

